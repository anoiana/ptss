---
params:
  update_date: FALSE
date: "`r source('_supp/helper.R'); newdate_func(params$update_date)`"
title: "`r totitle('giới thiệu về bayes')`"
output: 
  bookdown::html_document2:
    code_folding: hide
    number_sections: true
bibliography: ["_supp/citation.bib"]
link-citations: true
---

\newcommand{\bf}[1]{\boldsymbol{#1}}
\newcommand{\hat}[1]{\widehat{#1}}
\newcommand{\mm}[1]{\mathbb{#1}}
\newcommand{\bar}[1]{\overline{#1}}
\newcommand{\tp}[1]{{#1}^{\top}}
\newcommand{\scr}[1]{\mathscr{#1}}

\def\E{\Bbb{E}}
\def\V{\Bbb{V}}
\def\P{\Bbb{P}}
\def\I{{\large\unicode{x1D7D9}}}
\def\indep{\perp\!\!\!\!\perp}
\newcommand{\overeq}[2]{\stackrel{#1}{#2}}
\def\epsilon{\varepsilon} 
\def\proved{\blacksquare\quad} 
---

::: {.watermark} 
_incompleted_
:::

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
source("_supp/helper.R")
library(tidyverse)
```

# Bayes's formula

We shall start with Bayes's formula with two events $\theta$ and $X$:
$$
\P(\theta|X) = \frac{\P(X|\theta)\P(\theta)}{\P(X)};
(\#eq:eq1)
$$
where $\theta$ is parameter of interest and $X$ represents for observed data. To understand `r lb(eq1)` intuitively let us deem the following example

:::{.example #exm1}
We have 2 coins A and B with the probability of getting a head is $0.2$ and $0.7$, respectively. We randomly choose a coin, flip it $5$ times and save the result. We also know that coin A is selected with probability $\theta = 0.5$. We are interested in probability of choosing coin A after observing data. 
:::

We know that a selected coin is flipped $5$ with probability $p$ in which $p=0.2$ if coin A is selected and $p=0.7$, otherwise. Thus, 
$$
X \sim \mathcal{B}in(5,p),
$$
where $X$ is the number of head. 

Suppose After experiment has been conducted, we have 3 heads and 2 tails. Thus, the  probability with coin A selected is 
$$
\P(X=3|A) = {5 \choose 3}0.2^30.8^2 = 0.0512,
$$
and 
$$
\P(X=3|B) = {5 \choose 3}0.7^30.3^2 = 0.3087,
$$
if coin B was selected. 

Applying `r lb(eq1)` we calculate 
$$
\begin{aligned}
\P(A|X=3) &= \frac{\P(X=3|A)\P(A)}{\P(X=3|A)\P(A)+ \P(X=3|B)\P(B)} \\
&= \frac{0.0512(0.5)}{0.0512(0.5)+ 0.3087(0.5)}\\
&= 0.1423
\end{aligned}
(\#eq:eq2)
$$

Let us write a generic function to calculate `r lb(eq2)` and use the function to calculate when the number of observed Heads is $x = \tp{(0,1,2,3,4,5)}$

```{r, fig.align='center', fig.cap="*Probability coin A is selected given x Heads was observed*", echo=TRUE}
f = function(x){
 p = dbinom(x,5,0.2)
 p1 = dbinom(x,5,0.7)
 p/(p+p1)
}

tibble(`X = x` = 0L:5L, `P(A|X=x)` = sapply(0:5,f))%>%
 mutate(across(where(is.double), round, digits = 3))%>%
 draw_table()
```

Intuitively, we know the probability coin A landing on a head is $0.2$ moderately smaller than $0.7$ that is the probability coin B lands on a head . Thus, If the number of head is zero, it can be more likely that coin A was chosen, it probability is $0.993$, and when the number of head increases this probability is smaller. We see that if all 5 realizations come up with head, we have the probability of $0.002$, which means the possibility of choosing coin A is not feasible. 












<!-- --------------------------------------------------------------------------- -->

# *References* {-}
