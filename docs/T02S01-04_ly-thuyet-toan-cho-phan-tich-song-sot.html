<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>✑ Lý Thuyết Toán Cho Phân Tích Sống Sót</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
  <link rel="icon" type="image/png" href="img/fugu.png"/>

<div class="hero-image">
        <div class="image-text">
          <div class="top-text"> </div>
            <div class="bottom-text"> </div>
        </div>
</div>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANOIANA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bookmark"></span>
     
    Readings
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">I. SURVIVAL ANALYSIS</li>
    <li>
      <a href="T01S01-01_summary-of-nonparametric-survival-analysis.html">1. Summary of nonparametric survival analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">II. OTHER TOPICS</li>
    <li>
      <a href="T01S02-01_lim-inf-lim-sup.html">1. Limit of Supremum and Infimum.</a>
    </li>
    <li>
      <a href="T01S02-02_proof-of-maic.html">2. MAIC Proof.</a>
    </li>
    <li>
      <a href="T01S02-03_ci-2x2-tables.html">3. Construction of confidence intervals with 2x2 tables</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bookmark"></span>
     
    Đọc sách
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">I. PHÂN TÍCH SỐNG SÓT (1)</li>
    <li>
      <a href="T02S01-01_tong-quan-phan-tich-song-sot.html">1. Giới thiệu về phân tính sống sót</a>
    </li>
    <li>
      <a href="T02S01-02_phuong-phap-phi-tham-so.html">2. Phương pháp phi tham số</a>
    </li>
    <li>
      <a href="T02S01-03_so-sanh-2-mau-phi-tham-so.html">3. So sánh 2 mẫu với phương pháp phi tham số</a>
    </li>
    <li>
      <a href="T02S01-04_ly-thuyet-toan-cho-phan-tich-song-sot.html">4. Lý thuyết toán trong phân tích sống sót</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">II. SUY LUẬN BAYES</li>
    <li>
      <a href="T02S02-01_gioi-thieu-bayes.html">1. Giới thiệu Bayes.</a>
    </li>
    <li>
      <a href="T02S02-02_tinh-toan-bayes.html">2. Các phương pháp tính toán với Bayes</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">III. CÁC CHỦ ĐỀ RIÊNG</li>
    <li>
      <a href="T02S03-01_em-algorithm-1.html">1. Thuật toán Expectation-Maximization (EM) [1/3].</a>
    </li>
    <li>
      <a href="T01S03-02_em-algorithm-2.html">2. Thuật toán Expectation-Maximization (EM) [2/3].</a>
    </li>
    <li>
      <a href="T02S03-03_em-algorithm-3.html">3. Thuật toán Expectation-Maximization (EM) [3/3].</a>
    </li>
    <li>
      <a href="T02S03-04_bootstrap.html">4. Bootstrap</a>
    </li>
    <li>
      <a href="T02S03-05_he-so-anh-huong.html">5. Hệ số ảnh hưởng và ý nghĩa của các hệ số trong mô hình logistics.</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">✑ Lý Thuyết Toán Cho Phân Tích Sống Sót</h1>
<h4 class="date">📅 2021-06-13</h4>

</div>


<div class="watermark">
<p><em>DRAFT</em></p>
</div>
<p><span class="math inline">\(\varnothing\)</span></p>
<div class="right shad">
<p><span class="citation">(tham khảo: <a href="#ref-aal2008" role="doc-biblioref">Aalen, Borgan, and Gjessing 2008</a>)</span></p>
</div>
<hr />
<!-- ===================== START FROM HERE ========================== -->
<div id="quá-trình-ngẫu-nhiên-của-biến-gian-rời-rạc" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Quá Trình Ngẫu Nhiên Của Biến Gian Rời Rạc</h1>
<div id="đặc-tính-martingales" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Đặc Tính Martingales</h2>
<p>Ta có <span class="math inline">\(M = \{M_0,M_1,\dots\}\)</span> là quá trình ngẫu nhiên trong cột thời gian rời rạc. <span class="math inline">\(M\)</span> là một có tính chất martingale khi
<span class="math display" id="eq:eq1">\[
\Bbb{E}(M_n|M_0,M_1,\dots,M_{n-1}) = M_{n-1}, \quad n \ge 1
\tag{1.1}
\]</span>
Đặc tính này liên quan tới “fair game,” nghĩa là dựa trên các thông tin ta có được sau khi quan sát <span class="math inline">\(n-1\)</span> trò chơi thì thông tin tăng lên mà ta kỳ vọng cho trò chơi tiếp theo sẽ không thay đổi.</p>
<p>Tạm gọi <span class="math inline">\(\mathscr{H}_n\)</span> là thông tin tích lũy đến thời điểm thứ <span class="math inline">\(n\)</span>. Trong lý thuyết về tập hợp ta có thể xem <span class="math inline">\(\{\mathscr{H}_n\}\)</span> là một tập hợp, số lượng phần tử của tập hợp này sẽ tăng dần khi lần lượt đi qua các mốc thời gian (đi càng nhiều, chứng kiền càng nhiều, kiến thức càng nhiều). Ví dụ, ta ném 3 đồng xu thì ta biết trước có tất cả 8 trường hợp có thể xảy ra nhưng ta không biết cụ thể trường hợp nào, và ta cũng không biết trường hợp nào có nhiều khả năng hơn trường hợp nào. Nói cách khác tất cả các khả năng đều ngang bằng nhau, cũng có thể nói ta không có bất kỳ thông tin nào. 8 trường hợp đó là
<span class="math display">\[
M_0 = \{(HHH, HHT, HTH, HTT, THH,THT, TTH, TTT)\},
\]</span>
ở giai đoạn đầu tiên này, ta không hề có bất kỳ thông tin gì ngoài việc ba đồng xu sẽ được ném lên. Tuy nhiên, sau khi 1 đồng xu được ném lên, ta biết rằng sẽ có 2 trường hợp có thể xảy ra, và ta sẽ có sự phân bố các phần tử như sau
<span class="math display">\[
M_1 = \{(HHH, HHT, HTH, HTT), (THH,THT, TTH, TTT)\},
\]</span>
sau khi đồng xu thứ 2 được ném ra, ta có sự phân bố như sau
<span class="math display">\[
M_2 = \{(HHH, HHT),(HTH,HTT),(THH,THT), (TTH,TTT)\},
\]</span>
cuối cùng sau khi đồng xu thứ 3 được ném ra ta sẽ biết được tất cả thông tin, và sự phân bố bây giờ là
<span class="math display">\[
M_3 = \{(HHH), (HHT), (HTH), (HTT), (THH), (THT), (TTH), (TTT)\}.
\]</span>
Sau mỗi một đồng xu được ném ra và quan sát ta lại có thêm thông tin, và sự phân nhóm của tập hợp ban đầu có sự thay đổi theo chiều hướng chi tiết hơn, cho đến khi cả 3 đồng xu được ném ra thì ta có đầy đủ thông tin để khẳng định kiểu hình của 3 đồng xu đó là gì. Một lưu ý ta cần nhớ là thông tin ta có sau mỗi một đồng xu được ném ra nhiều hơn và bao gồm các thông tin trước đó. Nghĩa là
<span class="math display">\[
\begin{aligned}
&amp;\mathscr{H}_0 = \{M_0, \varnothing\} \\
&amp;\mathscr{H}_1 = \{M_0, M_1, \varnothing\} \\
&amp;\mathscr{H}_2 = \{M_0, M_1, M_2, \varnothing\} \\
&amp;\mathscr{H}_3 = \{M_0, M_1, M_2, M_3, \varnothing\}
\end{aligned}
\]</span>
theo lý thuyết tập hợp ta có thể ký hiệu quá trình này là
<span class="math display">\[
\mathscr{H}_1 \subset \mathscr{H}_2 \subset \mathscr{H}_3.
\]</span></p>
<p>Như vậy ta nói rằng quá trình <span class="math inline">\(M = \{M_0, M_1, M_2, \dots\}\)</span> thích nghi với tiền sự (History) <span class="math inline">\(\{\mathscr{H}_n\}\)</span>. Và theo đó mỗi một biến ngẫu nhiên <span class="math inline">\(M_1, \dots, M_n\)</span> có thể tính toán (nghĩa là có thể tính ra xác suất cho mỗi trường hợp cụ thể). Lấy một ví dụ cụ thể là
<span class="math display">\[
\begin{aligned}
\mathscr{H}_1 = \begin{bmatrix}\color{red}{(HHH, HHT, HTH, HTT, THH,THT, TTH, TTT)} \\ 
\color{blue}{(HHH, HHT, HTH, HTT)}, \color{blue}{(THH,THT, TTH, TTT)}\\ 
\color{green}{\varnothing}\end{bmatrix}
\end{aligned}
\]</span>
Như vậy, sau khi quan sát đồng xu đầu tiên được ném ra, ta có thể tính được xác suất của các trường hợp trong <span class="math inline">\(\mathscr{H}_1\)</span> bằng phương pháp đếm trong tập hợp mẹ <span class="math inline">\(\Omega\)</span> chứa 8 điểm giống nhau về các đặc tính định lượng. Nghĩa là mỗi 1 điểm đều có xác suất là <span class="math inline">\(1/8\)</span>. Như vậy ta lần lượt tính được xác suất cả các trường hợp trên là (từ trên xuống, từ trái qua): <span class="math inline">\(\{1, 1/2, 1/2,0\}\)</span>.</p>
<div class="blackbox brainstorm">
<div class="center">
<p>Tại sao ta cần nắm kiến thức trên?</p>
</div>
<p>Liên hệ với phân tích sốt sót, ta thấy rằng cứ sau mỗi một bệnh nhân tử vong được ghi nhận, thì các giá trị của hàm sống sót, hàm nguy cơ,… đều thay đổi. Câu hỏi được đặc ra là liệu sau mỗi một ca tử vong ghi nhận được, thì ta có thể dự đoán gì về các ca tiếp theo? và liệu với các thông tin ta có cho tới thời điển hiện tại (tiền sự) thì sẽ trả lời được cho ta về điều gì trong những lần tới?</p>
</div>
</div>
<div id="đặc-tính-martingales-của-biến-thời-gian-rời-rạc" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Đặc Tính Martingales Của Biến Thời Gian Rời Rạc</h2>
<p>Như vậy <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq1">(1.1)</a> có thể được viết lại là
<span class="math display" id="eq:eq2">\[
\Bbb{E}(M_m|\mathscr{H}_n) = M_n, \quad \forall m \le n.
\tag{1.2}
\]</span>
Quá trình <span class="math inline">\(M = \{M_0, M_1, M_2,\dots\}\)</span> là một martingale tương ứng với tiền sự <span class="math inline">\(\{\mathscr{H}_n\}\)</span> nếu
<span class="math display" id="eq:eq3">\[
\Bbb{E}(M_n|\mathscr{H}_{n-1}) = M_{n-1}, \quad \forall n \ge 1,
\tag{1.3}
\]</span>
phương trình trên có thể suy rộng ra và khái quát như phương trình sau
<span class="math display" id="eq:eq4">\[
\Bbb{E}(M_n|\mathscr{H}_m) = M_m. \quad \forall n&gt;m
\tag{1.4}
\]</span></p>
<p>Như vậy nếu như <span class="math inline">\(M_0 =0\)</span> (tại thời gian <span class="math inline">\(t_0\)</span> không có ca tử vong nào xảy ra), ta có
<span class="math display" id="eq:eq5">\[
\Bbb{E}(M_n) = \Bbb{E}[\Bbb{E}(M_n|\mathscr{H}_0)] = \Bbb{E}(M_0) = 0. 
\tag{1.5}
\]</span></p>
<p>như vậy martingale sẽ có kỳ vọng là 0, gọi là một <em>“mean zero martingale”</em>, tương tự chúng ta cũng sẽ có</p>
<p><span class="math display">\[
Cov(M_m,M_n-M_m) = 0, \quad \forall n &gt; m
\]</span>
nghĩa là martingale có <em>uncorrelated increments</em>.</p>
<p>Từ <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq3">(1.3)</a> ta sẽ có</p>
<p><span class="math display" id="eq:eq6">\[
\Bbb{E}(M_n - M_{n-1}|\mathscr{H}_{n-1}) = 0, \quad \forall n &gt; 1
\tag{1.6}
\]</span>
<span class="math inline">\(\Delta M_n = M_n-M_{n-1}\)</span> gọi là hiệu martingale (martingale differences).</p>
</div>
<div id="sự-thay-đổi-của-quá-trình-ngẫu-nhiên" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Sự Thay Đổi Của Quá Trình Ngẫu Nhiên</h2>
<p>Có 2 sự thay đổi mà ta cần quan tâm, cái thứ nhất gọi là <em>quá trình thay đổi có thể dự đoán</em> được ký hiệu là <span class="math inline">\(\langle M \rangle\)</span> và được định nghĩa là tổng của phương sai có điều kiện
<span class="math display" id="eq:eq7">\[
\langle M \rangle_n = \sum_{i=1}^n \Bbb{E}\{(M_i-M_{i-1}^2|\mathscr{H}_{i-1}\} = \sum_{i=1}^n\Bbb{V}(\Delta M_i|\mathscr{H}_{i-1})
\tag{1.7}
\]</span>
biết rằng <span class="math inline">\(\langle M \rangle_0 = 0\)</span>. quá trình thay đổi thứ hai gọi là <em>quá trình thay đổi tùy ý</em>, ký hiệu <span class="math inline">\([M]\)</span> và được định nghĩa như sau
<span class="math display">\[
[M]_n = \sum_{i=1}^n (M_i-M_{i-1})^2 = \sum_{i=1}^n (\Delta M_i)^2, \quad n \ge 0
\]</span>
biết rằng <span class="math inline">\([M]_0 = 0\)</span>. Ta có thể chứng minh được rằng</p>
<p><span class="math display" id="eq:eq9">\[
M^2 - \langle M \rangle \text{ chính là martingale có kỳ vọng bằng 0}
\tag{1.8}
\]</span></p>
<p><span class="math display" id="eq:eq10">\[
M^2 - [M] \text{ chính là martingale có kỳ vọng bằng 0}
\tag{1.9}
\]</span></p>
<div class="blackbox brainstorm">
<div class="center">
<p>Chứng minh <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq10">(1.9)</a> như sau</p>
</div>
<p>Với <span class="math inline">\(M^2_n\)</span>, ta có thể ghi lại như sau
<span class="math display">\[
\begin{aligned}
&amp;M_n^2 = (M_n - M_{n-1} + M_{n-1})^2 \\
&amp; [M]_n = \sum_{i=1}^{n-1}(M_i-M_{i-1})^2 + (M_n - M_{n-1})^2 = [M]_{n-1}+ (N_n-M_{n-1})^2
\end{aligned}
\]</span>
thus,
<span class="math display">\[
\begin{aligned}
\Bbb{E}(M_n^2-[M]_n|\mathscr{H}_{n-1}) &amp;= \Bbb{E}[2M_{n-1}(M_n-M_{n-1}) + M_{n-1}^2  - [M]_{n-1}|\mathscr{H}_{n-1}] \\
&amp;= M^2_{n-1} - [M]_{n-1}+2M_{n-1}\Bbb{E}(M_n-M_{n-1}|\mathscr{H}_{n-1}) \\
&amp;= M_{n-1}^2 - [M]_{n-1}
\end{aligned}
\]</span></p>
</div>
<p style="float:right; font-size:18px">
<span class="math inline">\(\blacksquare\)</span>
</p>
</p>
</div>
<div id="thời-gian-ngừng" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Thời Gian Ngừng</h2>
<p><em>stopping time</em> hay thời gian ngừng là khoảng thời gian phải có để một sự kiện nào đó xảy ra. Ta có thể định nghĩa thời gian ngừng như sau
<span class="math display" id="eq:eq11">\[
M_{n}^T = M_{n \wedge T}, \quad [n \wedge T := \min(n,T)]
\tag{1.10}
\]</span>
nghĩa là nếu thời gian xem xét là <span class="math inline">\(T = t\)</span> thì tại các mốc thời gian trước <span class="math inline">\(t\)</span> sẽ chính là giá trị của mốc thời gian đó, còn các mốc thời gian sau <span class="math inline">\(t\)</span> sẽ luôn là <span class="math inline">\(t\)</span>. Đối với thời gian ngừng trong <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq11">(1.10)</a> ta có thể chỉ ra rằng nó cũng có tính chất martingale. Tuy nhiên ta sẽ xem xét trường hợp tổng quát trước rồi sẽ xem xét trường hợp đặc trưng sau.</p>
<p>Thông thường ta sẽ không chứng minh trực tiếp đặc tính martingale của thời gian ngừng mà sẽ thông qua một bước đổi biến. Gọi <span class="math inline">\(X = \{X_i\}_{i=0,1,\dots}\)</span> là một quá trình tổng quát với tiền sự <span class="math inline">\(\{\mathscr{H}_n\}\)</span>, và <span class="math inline">\(H = \{H_i\}_{i=0,1,\dots}\)</span> là một quá trình có thể dự đoán <em>(predictable process)</em>, với già thuyết này thì <span class="math inline">\(H_n\)</span> sẽ có thể tính toán dựa trên tiền sự <span class="math inline">\(\mathscr{H}_{n-1}\)</span>. Như vậy ta đổi biến <span class="math inline">\(X\)</span> thành biến <span class="math inline">\(Z\)</span> như sau
<span class="math display" id="eq:eq12">\[
Z_n = H \bullet X = H_0X_0+H_1(X_1-X_0)+ \dots + H_{n-1}(X_{n-1}-X_{n-2})+ H_{n}(X_{n}-X_{n-1}),
\tag{1.11}
\]</span>
như vậy ta có thể chỉ ra rằng
<span class="math display">\[
\begin{aligned}
\Bbb{E}(Z_n - Z_{n-1}|\mathscr{H}_{n-1}) &amp;= \Bbb{E}[H_n(M_n-M_{n-1})|\mathscr{H}_{n-1}] \\
&amp;= H_n\Bbb{E}(M_n-M_{n-1}|\mathscr{H}_{n-1}) = 0,
\end{aligned}
\]</span>
ta kết luận rằng nếu <span class="math inline">\(M\)</span> là martingle thì <span class="math inline">\(Z\)</span> cũng như thế. Ngoài ra vì <span class="math inline">\(Z_0 = H_0M_0 = 0\)</span> nên <span class="math inline">\(Z\)</span> là martingale có kỳ vọng là 0.</p>
<p>Với <span class="math inline">\(n\)</span> lớn hơn <span class="math inline">\(1\)</span> ta sẽ có
<span class="math display" id="eq:eq13">\[
Z_n = (H \bullet M)_n = {\boldsymbol{H}}^{\top}\Delta\boldsymbol{M}
\tag{1.12}
\]</span>
với <span class="math inline">\(\boldsymbol{H} = {(H_1,H_2,\dots,H_n)}^{\top}\)</span> và <span class="math inline">\(\Delta\boldsymbol{M} = {(\Delta M_1, \Delta M_2, \dots, \Delta M_n)}^{\top}\)</span> với <span class="math inline">\(\Delta M_s = M_s - M_{s-1}\)</span>. Ta sẽ thấy ở các phần sau rằng nhờ các phương pháp đổi biến phù hợp các tích phân sẽ trở nên đơn giản hơn. Ta nhớ rằng ký hiệu <span class="math inline">\(\langle . \rangle\)</span> chính là đại lượng moment thứ hai có điều kiện (moment thứ hai tương đương với phương sai), nghĩa là <span class="math inline">\(\langle M\rangle = \Bbb{V}(\Delta M|\mathscr{H}_{i-1})\)</span>, do đó ta có
<span class="math display">\[
\langle H \bullet M \rangle = H^2\bullet \langle M \rangle \quad and \quad [H\bullet M] = H^2\bullet[M]
\]</span>
tổng quát hơn ta có
<span class="math display" id="eq:eq1415">\[
\begin{align}
&amp;\langle H\bullet M\rangle_m = \sum_{s=1}^nH_s^2\Delta\langle M \rangle_s, &amp;&amp; (a)  \\ &amp;[H\bullet M]_n = \sum_{s=1}^nH_s^2\Delta[M]_s &amp;&amp; (b)
\end{align}
\tag{1.13}
\]</span>
tham khảo <span class="citation"><a href="#ref-aal2008" role="doc-biblioref">Aalen, Borgan, and Gjessing</a> (<a href="#ref-aal2008" role="doc-biblioref">2008</a>)</span> cho phần chứng minh <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq1415">(1.13)</a>.</p>
</div>
<div id="phân-tích-doob-doob-decomposition" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Phân Tích Doob (Doob Decomposition)</h2>
<p>Mục tiêu chính của <em>phân tích Doob</em> là giải thích sự thay đổi của một quá trình ngẫu nhiên như là một hàm số của biến tiền sự. Gọi <span class="math inline">\(M = \{M_i\}_{i=0,1,\dots,n.}\)</span> là một quá trình ngẫh nhiên bất kỳ, <span class="math inline">\(X = \{X_i\}_{i=1,2,\dots,n.}\)</span> là quá trình ngẫu nhiên thích nghi với tiền sự <span class="math inline">\(\{\mathscr{H}_n\}\)</span>. Trong đó <span class="math inline">\(M\)</span> có tính chất sau
<span class="math display">\[
\Delta M_n = M_n-M_{n-1} = X_n -\Bbb{E}(X_n|\mathscr{H}_{n-1})
\]</span>
như vậy
<span class="math display" id="eq:eq16">\[
X_n = \Bbb{E}(X_n|\mathscr{H}_{n-1}) + \Delta M_n,
\tag{1.14}
\]</span>
<span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq16">(1.14)</a> tương ứng với một mô hình thống kê bình thường <span class="math inline">\(\boldsymbol{y} = \boldsymbol{{\beta}^{\top}X}+ \boldsymbol{\varepsilon}\)</span>. Thật vậy, ta thấy rằng dữ kiện <span class="math inline">\(\Bbb{E}(\boldsymbol{Y}) = \boldsymbol{{\beta}^{\top}X}\)</span> tương đương với <span class="math inline">\(X_n\)</span> và <span class="math inline">\(\Bbb{E}(X_n|\mathscr{H}_{n-1})\)</span> trong <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq16">(1.14)</a> và <span class="math inline">\(\Bbb{E}(\boldsymbol{\varepsilon}) = \boldsymbol{0}\)</span> tương đương với <span class="math inline">\(\Bbb{E}(\Delta M_n|\mathscr{H}_{n-1}) = 0\)</span>. Như vậy <span class="math inline">\(X_n\)</span> sẽ được hồi quy bằng theo một hàm số của <span class="math inline">\(\mathscr{H}_{n-1}\)</span>.</p>
</div>
</div>
<div id="quá-trình-ngẫu-nhiên-với-biến-thời-gian-liên-lục" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Quá Trình Ngẫu Nhiên Với Biến Thời Gian Liên Lục</h1>
<p>Phần này thật ra là giống như phần trên, tuy nhiên các ký hiệu cần phải thay đổi cho phù hợp với biến liên tục.</p>
<div id="martingales-với-biến-thời-gian-liên-tục" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Martingales Với Biến Thời Gian Liên Tục</h2>
<p>Đối với một quá trình ngẫu nhiên ta sẽ ký hiệu là
<span class="math display">\[
X = \{X(t): t \in [0,\tau]\}
\]</span>
thích nghi với tiền sự <span class="math inline">\(\mathscr{H}_t\)</span>. Có nghĩa là tại thời điểm <span class="math inline">\(t\)</span> ta biết tất cả thông tin của <span class="math inline">\(s\)</span> với <span class="math inline">\(s\le t\)</span>. Tất cả những giá trị của <span class="math inline">\(X\)</span> biến thiên theo thời gian <span class="math inline">\(t\)</span> gọi là <em>sample path</em>. Nếu sample path liên tục bên phải và tồn tại giới hạn trái thì ta gọi là <em>cadlag (continue à droite, limité à gauche)</em>.</p>
<p>Bởi vì <span class="math inline">\(X_t\)</span> thích nghi với <span class="math inline">\(\mathscr{H}_t\)</span> và thỏa mãn tính chất martingale nên
<span class="math display" id="eq:eq17">\[
\Bbb{E}[M(t)|\mathscr{H}_s] = M(s), \quad \forall s&lt;t
\tag{2.1}
\]</span>
tương đương với
<span class="math display">\[
\Bbb{E}(dM(t)|\mathscr{H}_{t^-}) = 0
\]</span>
trong đó <span class="math inline">\(dM(t)\)</span> là sự tăng lên trong một khoảng thời gian vô cùng nhỏ là <span class="math inline">\([t,t+dt)\)</span> và <span class="math inline">\(\mathscr{H}_{t^-}\)</span> là tiền sự ngay trước thời điểm <span class="math inline">\(t\)</span>.</p>
<p>Tương tự trường hợp của biến rời rạc, ta cũng có thể chứng minh <span class="math inline">\(\Bbb{E}[M(t)] = 0\)</span>, tức là <span class="math inline">\(M(t)\)</span> là một martingale có kỳ vọng bằng 0. Ngoài ra, một số đặc tính tương tự như trong trường hợp rời rạc mà ta cần nhắc lại như sau</p>
<ul>
<li><em>Bất tương quan:</em>
<span class="math display" id="eq:eq18">\[
\mathbb{Cov}[M(t) - M(s), M(k) - M(l)] = 0,\quad 0 \le s &lt; t &lt; l &lt; k \le \tau
\tag{2.2}
\]</span></li>
</ul>
</div>
<div id="tích-phân-trong-quá-trình-ngẫu-nhiên" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Tích Phân Trong Quá Trình Ngẫu Nhiên</h2>
</div>
<div id="quá-trình-ngẫu-nhiên-poisson" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Quá Trình Ngẫu Nhiên Poisson</h2>
<p>Quá trình ngẫu nhiên poisson đồng nhất mô tả những sự kiện xảy ra hoàn toàn độc lập. Đại lượng được quan tâm là tốc độ xảy ra sự kiện, hay gọi là cường độ <span class="math inline">\(\lambda\)</span>, trong đó <span class="math inline">\(\lambda dt\)</span> là xác suất <strong>của một sự kiện xảy ra in khoảng thời gian <span class="math inline">\([t,t+dt)\)</span>.</strong> Một vài đặc tính của nó là</p>
<ol style="list-style-type: decimal">
<li>Khoảng thời gian giữa những sự kiện thuộc phân bố <span class="math inline">\(\mathcal{Exponential}\)</span>, nghĩa là <span class="math inline">\(T \sim \mathcal{Exponential}(\lambda)\)</span>.</li>
<li>Số sự kiện xảy ra trong một khoảng thời gian <span class="math inline">\(h\)</span> thuộc phân bố <span class="math inline">\(\mathcal{Poisson}\)</span>, nghĩa là nếu có <span class="math inline">\(k\)</span> sự kiện xảy ra thì xác suất là <span class="math inline">\((\lambda h)^ke^{-\lambda h}/k!.\)</span></li>
<li>Vì thế giá trị kỳ vọng và phương sai của số sự kiện xảy ra trong khoảng thời gian <span class="math inline">\(h\)</span> là <span class="math inline">\(\lambda h\)</span></li>
<li>Số sự kiện xảy ra trong mỗi 2 khoảng thời gian không trùng lên nhau thì độc lập với nhau.</li>
</ol>
<p>Gọi <span class="math inline">\(N(t)\)</span> là số sự kiện xảy ra tính tới thời điểm <span class="math inline">\(t\)</span> nghĩa là <span class="math inline">\([0,t]\)</span>, ta có một quá trình
<span class="math display" id="eq:eq35">\[
M(t) = N(t) -\lambda t
\tag{2.3}
\]</span>
Ta thấy rằng <span class="math inline">\(N(t)\)</span> là số sự kiện xảy ra tính đến thời điểm <span class="math inline">\(t\)</span>, thuộc phân bố <span class="math inline">\(\mathcal{Poisson}\)</span> có tham số <span class="math inline">\(\lambda t\)</span>, vì thế <span style="color: #C46ADD; font-size: 18px;"><em>Eq.</em></span> <a href="#eq:eq35">(2.3)</a> chính là quá trình ngẫu nhiên <span class="math inline">\(\mathcal{Poisson}\)</span> đã được chuẩn hóa trung tâm về <span class="math inline">\(0\)</span>. Lấy <span class="math inline">\(\mathscr{H}_t\)</span> là tiền sự trong khoảng thời gian <span class="math inline">\([0,t]\)</span>. Giả sử <span class="math inline">\(t&gt;s\)</span>, ta có
<span class="math display">\[
\Bbb{E}[M(t)-M(s)|\mathscr{H}_s] \stackrel{\text{độclập}}{=} \Bbb{E}[M(t) - M(s)] = \Bbb{E}[N(t)-N(s)] -(t-s)\lambda = 0
\]</span>
như vậy
<span class="math display" id="eq:eq36">\[
\Bbb{E}[M(t)|\mathscr{H}_s] = M(s).
\tag{2.4}
\]</span>
và <span class="math inline">\(\lambda t\)</span> là bổ chính của quá trình <span class="math inline">\(\mathcal{Poisson}\)</span> . Bên cạnh đó bởi vì
<span class="math display">\[
\Bbb{E}[M^2(t)-\lambda t|\mathscr{H}_s] = M^2(s)-\lambda t
\]</span>
ta có thể chứng minh được rằng <span class="math inline">\(\lambda t\)</span> cũng là một bổ chính của <span class="math inline">\(M^2(t)\)</span>, vì thế
<span class="math display" id="eq:eq38">\[
\langle M \rangle(t) = \lambda t
\tag{2.5}
\]</span></p>
</div>
<div id="quá-trình-ngẫu-nhiên-đếm" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Quá Trình Ngẫu Nhiên Đếm</h2>
<p>Một <em>quá trình đếm (counting process)</em> <span class="math inline">\(N\)</span> được định nghĩa là <span class="math inline">\(\{N(t): t \in[0,\tau]\}\)</span>. <span class="math inline">\(N\)</span> là một quá trình liên tục phải với khoảng cách của mỗi bậc là <span class="math inline">\(1\)</span> tại thời điểm xảy ra sự kiện. Ta có thể minh họa bằng thời gian tái phát bệnh của một bệnh nhân như hình bên dưới</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-1"></span>
<img src="T02S01-04_ly-thuyet-toan-cho-phan-tich-song-sot_files/figure-html/unnamed-chunk-1-1.png" alt="*thời gian tái phát bệnh của một bệnh nhân*" width="672" />
<p class="caption">
Figure 2.1: <em>thời gian tái phát bệnh của một bệnh nhân</em>
</p>
</div>
<p>Ta nói rằng quá trình đếm <span class="math inline">\(N\)</span> “thích nghi” với tiền sự <span class="math inline">\(\{\mathscr{H}_t\}\)</span> nghĩa là tại mỗi mốc thời gian <span class="math inline">\(t\)</span>, ta đều có thể tính toán dựa vào tiền sự <span class="math inline">\(\mathscr{H}_t\)</span>. Cường độ <span class="math inline">\(\lambda(t)\)</span> tại <span class="math inline">\(t\)</span> của một quá trình đếm là
<span class="math display" id="eq:eq39">\[
\begin{align}
\lambda(t)dt &amp;= \Bbb{P}[dN(t)=1|\mathscr{H}_{t^-}] \\
&amp;= \Bbb{E}[dN(t)|\mathscr{H}_{t^-}]
\end{align}
\tag{2.6}
\]</span></p>
<!-- ====================== END ====================================== -->
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1><em>References</em></h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aal2008" class="csl-entry">
Aalen, Odd, Ornulf Borgan, and Hakon Gjessing. 2008. <em>Survival and Event History Analysis: A Process Point of View</em>. Springer Science &amp; Business Media.
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
